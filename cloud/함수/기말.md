# ë¬¸ì œ: "ì¢‹ì•„ìš” ê¸°ë¡ ì‹œìŠ¤í…œ ë§Œë“¤ê¸°"
## ë‹¹ì‹ ì€ ì‚¬ìš©ìë“¤ì´ ìƒí’ˆì— ëŒ€í•´ "ì¢‹ì•„ìš”"ë¥¼ ëˆ„ë¥¸ ì •ë³´ë¥¼ ì €ì¥í•˜ê³ , ì´ë¥¼ DynamoDBë¥¼ ì´ìš©í•´ ê´€ë¦¬í•˜ëŠ” ì‹œìŠ¤í…œì„ êµ¬ì¶• ì¤‘ì…ë‹ˆë‹¤. ì´ë¯¸ ì•„ë˜ì™€ ê°™ì€ êµ¬ì„±ìš”ì†Œê°€ ì¡´ì¬í•©ë‹ˆë‹¤:

```json
  {
  "user_id": "seung",
  "timestamp": "2025-06-12T13:00:00",
  "product": "ì œë¡œì½œë¼",
  "brand": "ì½”ì¹´ì½œë¼",
  "reason": "ë§›ìˆì–´ìš”"
}
```
### sgu-202563-dynamo
#### íŠ¹ì • ê°’ì„ DynamoDB í…Œì´ë¸”ì— ë„£ëŠ” ê°€ì¥ ê¸°ë³¸ì ì¸ Lambda í•¨ìˆ˜ì…ë‹ˆë‹¤.
```python
  # AWS DynamoDBì— ì ‘ê·¼í•˜ê¸° ìœ„í•œ boto3 ë¼ì´ë¸ŒëŸ¬ë¦¬ import
import boto3

# Lambda í•¨ìˆ˜ì˜ ì‹œì‘ì . AWSê°€ ì´ í•¨ìˆ˜ë¥¼ ì‹¤í–‰í•  ë•Œ í˜¸ì¶œí•¨
def lambda_handler(event, context):
    # DynamoDB ë¦¬ì†ŒìŠ¤ë¥¼ ìƒì„±
    dynamodb = boto3.resource('dynamodb')

    # í…Œì´ë¸” ì´ë¦„ìœ¼ë¡œ DynamoDB í…Œì´ë¸” ê°ì²´ ìƒì„±
    table = dynamodb.Table('sgu-202563-user-likes')

    # put_item()ì„ ì´ìš©í•´ ë°ì´í„°ë¥¼ í…Œì´ë¸”ì— ì‚½ì…
    response = table.put_item(
        Item={  # ì €ì¥í•  í•­ëª© (ë”•ì…”ë„ˆë¦¬ í˜•íƒœ)
            'user_id': 'seung',           # íŒŒí‹°ì…˜ í‚¤: ì‚¬ìš©ì ID
            'product_name': 'ì œë¡œì½œë¼'    # ì €ì¥í•  í•­ëª©: ìƒí’ˆ ì´ë¦„
        }
    )

    # ì„±ê³µì ìœ¼ë¡œ ì‹¤í–‰ë˜ì—ˆìŒì„ ë‚˜íƒ€ë‚´ëŠ” ì‘ë‹µ ë°˜í™˜
    return {
        'statusCode': 200,                 # HTTP ìƒíƒœì½”ë“œ 200 (ì„±ê³µ)
        'body': 'PutItem successful!'      # ì‘ë‹µ ë©”ì‹œì§€ ë³¸ë¬¸
    }

```
---
### sgu-202563-dynamo-post-api
#### POST ìš”ì²­ì„ ë°›ì•„ì„œ ë°›ì€ ê°’ë“¤ì„ DynamoDBì— ì €ì¥í•˜ëŠ” Lambda í•¨ìˆ˜ì…ë‹ˆë‹¤.
```python
  # AWS ì ‘ê·¼ì„ ìœ„í•œ boto3ì™€ JSON ë°ì´í„° ì²˜ë¦¬ë¥¼ ìœ„í•œ json ëª¨ë“ˆ import
import boto3
import json
from datetime import datetime  # í˜„ì¬ ì‹œê°„ ê¸°ë¡ì„ ìœ„í•œ ëª¨ë“ˆ

# Lambda í•¨ìˆ˜ ì‹œì‘
def lambda_handler(event, context):
    try:
        # API Gatewayë¥¼ í†µí•´ ë“¤ì–´ì˜¨ ìš”ì²­ì˜ ë³¸ë¬¸(JSON)ì„ íŒŒì‹±
        body = json.loads(event['body'])

        # í•„ìˆ˜ ê°’ ì¶”ì¶œ
        user_id = body['user_id']            # ì‚¬ìš©ì ID
        product = body['product']            # ìƒí’ˆ ì´ë¦„
        timestamp = datetime.now().isoformat()  # í˜„ì¬ ì‹œê°ì„ ISO í¬ë§· ë¬¸ìì—´ë¡œ ì €ì¥

        # ì„ íƒì ì¸ í•„ë“œë“¤ë„ ì¡´ì¬í•˜ë©´ ê°€ì ¸ì˜¤ê³  ì—†ìœ¼ë©´ None
        reason = body.get('reason')  # ì„ íƒ: ì´ìœ 
        brand = body.get('brand')    # ì„ íƒ: ë¸Œëœë“œ
        price = body.get('price')    # ì„ íƒ: ê°€ê²©
        color = body.get('color')    # ì„ íƒ: ìƒ‰ìƒ

        # ìµœì¢…ì ìœ¼ë¡œ ì €ì¥í•  ë”•ì…”ë„ˆë¦¬ êµ¬ì„±
        item = {
            'user_id': user_id,        # íŒŒí‹°ì…˜ í‚¤
            'timestamp': timestamp,    # ì •ë ¬ í‚¤
            'product': product         # ìƒí’ˆ ì´ë¦„
        }

        # ì„ íƒ í•­ëª©ì´ ì¡´ì¬í•  ê²½ìš°ì—ë§Œ ë”•ì…”ë„ˆë¦¬ì— ì¶”ê°€
        if reason:
            item['reason'] = reason
        if brand:
            item['brand'] = brand
        if price:
            item['price'] = price
        if color:
            item['color'] = color

        # DynamoDBì— ë°ì´í„° ì‚½ì…
        table = boto3.resource('dynamodb').Table('sgu-202563-user-likes-time')
        table.put_item(Item=item)

        # ì„±ê³µ ì‘ë‹µ ë°˜í™˜
        return {
            'statusCode': 200,  # ì„±ê³µ ìƒíƒœ ì½”ë“œ
            'body': json.dumps({
                'message': 'ì €ì¥ ì™„ë£Œ',        # ë©”ì‹œì§€
                'user_id': user_id,            # ì €ì¥ëœ ì‚¬ìš©ì
                'timestamp': timestamp         # ì €ì¥ëœ ì‹œê°„
            }, ensure_ascii=False)             # í•œê¸€ì´ ê¹¨ì§€ì§€ ì•Šë„ë¡ ì„¤ì •
        }

    # ì˜ˆì™¸ê°€ ë°œìƒí•  ê²½ìš° (ì˜ˆ: í•„ë“œ ì—†ìŒ, DynamoDB ì˜¤ë¥˜ ë“±)
    except Exception as e:
        return {
            'statusCode': 400,  # í´ë¼ì´ì–¸íŠ¸ ìš”ì²­ ì˜¤ë¥˜ ìƒíƒœ ì½”ë“œ
            'body': json.dumps({
                'error': str(e)  # ì—ëŸ¬ ë©”ì‹œì§€ë¥¼ ë¬¸ìì—´ë¡œ ë°˜í™˜
            }, ensure_ascii=False)
        }

```
---
### sgu-202563-likes-count
#### ì‚¬ìš©ìì˜ ì¢‹ì•„ìš” ì´ ê°œìˆ˜ì™€ ê°€ì¥ ë§ì´ ì¢‹ì•„ìš” ëˆ„ë¥¸ ìƒí’ˆì„ ì¡°íšŒí•˜ëŠ” í•¨ìˆ˜ì…ë‹ˆë‹¤.
```python
  # AWS DynamoDB ì ‘ê·¼ìš© boto3, ë¦¬ìŠ¤íŠ¸ ì¹´ìš´íŠ¸ìš© Counter import
import boto3
from collections import Counter

# Lambda í•¨ìˆ˜ ì‹œì‘
def lambda_handler(event, context):
    # DynamoDB ë¦¬ì†ŒìŠ¤ ê°ì²´ ìƒì„±
    dynamodb = boto3.resource('dynamodb')

    # ì‚¬ìš©í•  í…Œì´ë¸” ì´ë¦„ìœ¼ë¡œ í…Œì´ë¸” ê°ì²´ ìƒì„±
    table = dynamodb.Table('sgu-202563-user-likes-time')

    # ìš”ì²­ì—ì„œ user_id ê°’ ì¶”ì¶œ
    user_id = event.get('user_id')

    # user_idê°€ ì—†ìœ¼ë©´ ìš”ì²­ ì˜¤ë¥˜ ì²˜ë¦¬
    if not user_id:
        return {
            'statusCode': 400,            # 400: ì˜ëª»ëœ ìš”ì²­
            'body': 'user_idê°€ í•„ìš”í•©ë‹ˆë‹¤.'
        }

    try:
        # user_idë¥¼ ì¡°ê±´ìœ¼ë¡œ í•´ë‹¹ ì‚¬ìš©ìì˜ ëª¨ë“  ê¸°ë¡ ì¡°íšŒ
        response = table.query(
            KeyConditionExpression=boto3.dynamodb.conditions.Key('user_id').eq(user_id)
        )

        # Items í•­ëª©ì—ì„œ ì‹¤ì œ ë°ì´í„° ë¦¬ìŠ¤íŠ¸ ì¶”ì¶œ
        items = response.get('Items', [])

        # product í•„ë“œë§Œ ì¶”ì¶œí•´ì„œ ë¦¬ìŠ¤íŠ¸ ìƒì„±
        product_list = [item['product'] for item in items if 'product' in item]

        # ì¢‹ì•„ìš” ìˆ˜ = product ê°œìˆ˜
        total_likes = len(product_list)

        # ê°€ì¥ ë§ì´ ë“±ì¥í•œ ìƒí’ˆ 1ê°œë¥¼ ì°¾ìŒ (ì—†ì„ ìˆ˜ë„ ìˆìŒ)
        most_common = Counter(product_list).most_common(1)

        # ê²°ê³¼ê°€ ìˆìœ¼ë©´ ìƒí’ˆ ì´ë¦„, ì—†ìœ¼ë©´ None
        most_liked_product = most_common[0][0] if most_common else None

        # ìµœì¢… ê²°ê³¼ ë°˜í™˜
        return {
            'statusCode': 200,  # ì„±ê³µ
            'body': {
                'total_likes': total_likes,                   # ì¢‹ì•„ìš” ì´ ê°œìˆ˜
                'most_liked_product': most_liked_product      # ê°€ì¥ ë§ì´ ëˆ„ë¥¸ ìƒí’ˆ
            }
        }

    # ì˜ˆì™¸ ì²˜ë¦¬ (ì˜ˆ: í…Œì´ë¸” ì´ë¦„ ì˜¤íƒ€, ì‘ë‹µ ì˜¤ë¥˜ ë“±)
    except Exception as e:
        return {
            'statusCode': 500,             # ì„œë²„ ì˜¤ë¥˜
            'body': f'ì˜¤ë¥˜ ë°œìƒ: {str(e)}'  # ë°œìƒí•œ ì—ëŸ¬ ë©”ì‹œì§€ ì¶œë ¥
        }

```
---
### sgu-202563-likes-list
#### í•´ë‹¹ ì‚¬ìš©ìì˜ ì¢‹ì•„ìš” ì „ì²´ ëª©ë¡ì„ ê°€ì ¸ì˜¤ëŠ” Lambda í•¨ìˆ˜ì…ë‹ˆë‹¤.
```python
  # AWS SDK ë° JSON ë³€í™˜ìš© ë¼ì´ë¸ŒëŸ¬ë¦¬
import boto3
import json

# Lambda í•¨ìˆ˜ ì‹œì‘
def lambda_handler(event, context):
    # DynamoDB ë¦¬ì†ŒìŠ¤ ê°ì²´ ìƒì„±
    dynamodb = boto3.resource('dynamodb')

    # í…Œì´ë¸” ì´ë¦„ìœ¼ë¡œ DynamoDB í…Œì´ë¸” ê°ì²´ ìƒì„±
    table = dynamodb.Table('sgu-202563-user-likes-time')

    # ìš”ì²­ì—ì„œ user_id ê°’ì„ ê°€ì ¸ì˜´
    user_id = event.get('user_id')

    # user_idê°€ ì—†ìœ¼ë©´ ì˜¤ë¥˜ ë°˜í™˜
    if not user_id:
        return {
            'statusCode': 400,              # ì˜ëª»ëœ ìš”ì²­
            'body': 'user_idê°€ í•„ìš”í•©ë‹ˆë‹¤.'
        }

    try:
        # í•´ë‹¹ user_idì— ëŒ€í•œ ëª¨ë“  í•­ëª©ì„ ì¡°íšŒ
        response = table.query(
            KeyConditionExpression=boto3.dynamodb.conditions.Key('user_id').eq(user_id)
        )

        # ì¡°íšŒëœ ë°ì´í„° ë¦¬ìŠ¤íŠ¸ ê°€ì ¸ì˜¤ê¸°
        items = response.get('Items', [])

        # ê²°ê³¼ë¥¼ JSONìœ¼ë¡œ ë³€í™˜í•˜ì—¬ ë°˜í™˜
        return {
            'statusCode': 200,                  # ì„±ê³µ ì½”ë“œ
            'body': json.dumps(items, ensure_ascii=False)  # í•œê¸€ ê¹¨ì§ ë°©ì§€
        }

    # ì˜ˆì™¸ ë°œìƒ ì‹œ ì²˜ë¦¬
    except Exception as e:
        return {
            'statusCode': 500,             # ì„œë²„ ì˜¤ë¥˜
            'body': json.dumps({'error': str(e)}, ensure_ascii=False)  # ì—ëŸ¬ ë©”ì‹œì§€
        }

```
---
---

# [1] POSTë¡œ ë°ì´í„° ì €ì¥í•˜ëŠ” ì½”ë“œ (ì¤‘í•™ìƒ ì„¤ëª… í¬í•¨)

```python
  import boto3              # AWSë‘ ì—°ê²°í•  ìˆ˜ ìˆëŠ” ë„êµ¬ë¥¼ ê°€ì ¸ì™€ìš”
import json               # ë°ì´í„°ë¥¼ JSON í˜•ì‹ìœ¼ë¡œ ë°”ê¾¸ê¸° ìœ„í•´ ê°€ì ¸ì™€ìš”
from datetime import datetime  # í˜„ì¬ ë‚ ì§œì™€ ì‹œê°„ ì •ë³´ë¥¼ ê°€ì ¸ì˜¤ê¸° ìœ„í•´ ë¶ˆëŸ¬ì™€ìš”

def lambda_handler(event, context):   # ì´ í•¨ìˆ˜ëŠ” AWS Lambdaê°€ ì‹¤í–‰í•  ë•Œ ìë™ìœ¼ë¡œ ë¶ˆëŸ¬ì™€ìš”
    body = json.loads(event['body'])  # ì‚¬ìš©ìê°€ ë³´ë‚¸ ë°ì´í„°ë¥¼ JSONìœ¼ë¡œ ë°”ê¿”ì„œ ì½ì–´ìš”

    user_id = body['user_id']         # JSONì—ì„œ 'user_id'ë¼ëŠ” ê°’ì„ êº¼ë‚´ìš”
    product = body['product']         # JSONì—ì„œ 'product'ë¼ëŠ” ê°’ì„ êº¼ë‚´ìš”
    timestamp = datetime.now().isoformat()  # ì§€ê¸ˆ ë‚ ì§œì™€ ì‹œê°„ì„ ë¬¸ìì—´ë¡œ ë°”ê¿”ìš”

    table = boto3.resource('dynamodb').Table('í…Œì´ë¸”ì´ë¦„')  # 'í…Œì´ë¸”ì´ë¦„'ì´ë¼ëŠ” DynamoDB í…Œì´ë¸”ê³¼ ì—°ê²°í•´ìš”

    # DynamoDB í…Œì´ë¸”ì— ìƒˆë¡œìš´ ë°ì´í„°ë¥¼ ì €ì¥í•´ìš”
    table.put_item(Item={
        'user_id': user_id,       # ê¸°ë³¸ í‚¤ë¡œ user_idë¥¼ ë„£ì–´ìš”
        'timestamp': timestamp,   # ì •ë ¬ í‚¤ë¡œ timestampë¥¼ ë„£ì–´ìš”
        'product': product        # ì‚¬ìš©ìê°€ ì„ íƒí•œ ìƒí’ˆ ì´ë¦„ì„ ë„£ì–´ìš”
    })

    return {
        'statusCode': 200,        # ì„±ê³µí•˜ë©´ 200ì´ë¼ëŠ” ìƒíƒœì½”ë“œë¥¼ ë³´ë‚´ìš”
        'body': 'POSTë¡œ ë°ì´í„° ì €ì¥ ì™„ë£Œ'  # ì„±ê³µí–ˆë‹¤ëŠ” ë©”ì‹œì§€ë¥¼ ë³´ë‚´ìš”
    }
```
---
# [2] íŠ¹ì • ìœ ì €ì˜ ë°ì´í„° ê°€ì ¸ì˜¤ê¸° (GET)
```python
  import boto3             # AWS DynamoDBì™€ ì—°ê²°í•  ìˆ˜ ìˆê²Œ í•´ì£¼ëŠ” ë„êµ¬
import json              # ë°ì´í„°ë¥¼ JSON í˜•ì‹ìœ¼ë¡œ ë°”ê¿€ ë•Œ ì‚¬ìš©

def lambda_handler(event, context):  # Lambda í•¨ìˆ˜ì˜ ì‹œì‘ì 
    user_id = event.get('user_id')   # ì‚¬ìš©ì IDë¥¼ eventì—ì„œ êº¼ë‚´ìš”

    if not user_id:  # ë§Œì•½ user_idê°€ ì—†ìœ¼ë©´
        return {'statusCode': 400, 'body': 'user_id í•„ìš”'}  # ì—ëŸ¬ ë©”ì‹œì§€ë¥¼ ë³´ë‚´ìš”

    table = boto3.resource('dynamodb').Table('í…Œì´ë¸”ì´ë¦„')  # DynamoDB í…Œì´ë¸”ê³¼ ì—°ê²°í•´ìš”

    # user_idê°€ ê°™ì€ ë°ì´í„°ë¥¼ ëª¨ë‘ ì°¾ì•„ìš”
    response = table.query(
        KeyConditionExpression=boto3.dynamodb.conditions.Key('user_id').eq(user_id)
    )

    items = response.get('Items', [])  # ê²°ê³¼ì—ì„œ ì‹¤ì œ ë°ì´í„°ë¥¼ êº¼ë‚´ìš”

    return {
        'statusCode': 200,              # ì„±ê³µí–ˆë‹¤ëŠ” ìƒíƒœì½”ë“œ
        'body': json.dumps(items, ensure_ascii=False)  # ë°ì´í„°ë¥¼ JSONìœ¼ë¡œ ë°”ê¿”ì„œ ë³´ë‚´ì¤˜ìš”
    }
```
---
# [3] DynamoDBì—ì„œ íŠ¹ì • ë°ì´í„° ì‚­ì œí•˜ê¸° (DELETE)
```python
import boto3  # AWS ì„œë¹„ìŠ¤ì™€ ì—°ê²°í•  ìˆ˜ ìˆê²Œ í•´ì£¼ëŠ” ë„êµ¬

def lambda_handler(event, context):  # Lambda í•¨ìˆ˜ì˜ ì‹œì‘ì 
    user_id = event['user_id']       # ì‚­ì œí•  ë°ì´í„°ì˜ ì‚¬ìš©ì ID
    timestamp = event['timestamp']   # ì‚­ì œí•  ë°ì´í„°ì˜ ì‹œê°„ (ì •ë ¬ í‚¤)

    table = boto3.resource('dynamodb').Table('í…Œì´ë¸”ì´ë¦„')  # í…Œì´ë¸” ì—°ê²°

    # í…Œì´ë¸”ì—ì„œ í•´ë‹¹ ë°ì´í„°ë¥¼ ì‚­ì œí•´ìš”
    table.delete_item(
        Key={
            'user_id': user_id,       # ê¸°ë³¸ í‚¤
            'timestamp': timestamp    # ì •ë ¬ í‚¤
        }
    )

    return {
        'statusCode': 200,   # ì„±ê³µ ìƒíƒœ
        'body': 'ì‚­ì œ ì™„ë£Œ'   # ë©”ì‹œì§€ ì¶œë ¥
    }

```
---
# [4] DynamoDB ë°ì´í„° ìˆ˜ì •í•˜ê¸° (UPDATE)
```python
  import boto3  # AWS DynamoDBë‘ ì—°ê²°í•˜ëŠ” ë„êµ¬

def lambda_handler(event, context):  # Lambda í•¨ìˆ˜ ì‹œì‘
    user_id = event['user_id']           # ì–´ë–¤ ì‚¬ìš©ìì˜
    timestamp = event['timestamp']       # ì–¸ì œ ì…ë ¥í•œ ë°ì´í„°ë¥¼
    new_product = event['new_product']   # ì–´ë–¤ ê°’ìœ¼ë¡œ ë°”ê¿€ì§€ ê°€ì ¸ì™€ìš”

    table = boto3.resource('dynamodb').Table('í…Œì´ë¸”ì´ë¦„')  # í…Œì´ë¸” ì—°ê²°

    # ë°ì´í„°ë¥¼ ì—…ë°ì´íŠ¸(ìˆ˜ì •) í•´ìš”
    table.update_item(
        Key={
            'user_id': user_id,       # ê¸°ë³¸ í‚¤
            'timestamp': timestamp    # ì •ë ¬ í‚¤
        },
        UpdateExpression="SET product = :p",  # product ê°’ì„ ë°”ê¾¸ë¼ê³  ì•Œë ¤ì¤˜ìš”
        ExpressionAttributeValues={
            ':p': new_product         # ë°”ê¿€ ìƒˆ ê°’ì„ ì•Œë ¤ì¤˜ìš”
        }
    )

    return {
        'statusCode': 200,    # ì„±ê³µí–ˆë‹¤ëŠ” í‘œì‹œ
        'body': 'ì—…ë°ì´íŠ¸ ì™„ë£Œ'
    }

```
---
# [5] ì „ì²´ í†µê³„ êµ¬í•˜ê¸° (ê°€ì¥ ë§ì´ ì„ íƒëœ ìƒí’ˆ ë“±)
```python
  import boto3                         # AWS DynamoDBì— ì—°ê²°
from collections import Counter      # ê°€ì¥ ë§ì´ ë‚˜ì˜¨ ê°’ì„ ì°¾ê¸° ìœ„í•´ ì‚¬ìš©

def lambda_handler(event, context):  
    user_id = event['user_id']       # ì‚¬ìš©ì ID ê°€ì ¸ì˜¤ê¸°
    table = boto3.resource('dynamodb').Table('í…Œì´ë¸”ì´ë¦„')  # í…Œì´ë¸” ì—°ê²°

    # ì‚¬ìš©ì IDë¡œ ë°ì´í„° ê°€ì ¸ì˜¤ê¸°
    response = table.query(
        KeyConditionExpression=boto3.dynamodb.conditions.Key('user_id').eq(user_id)
    )

    items = response.get('Items', [])  # ë°ì´í„° êº¼ë‚´ê¸°
    products = [item['product'] for item in items]  # ìƒí’ˆë“¤ë§Œ ë¦¬ìŠ¤íŠ¸ë¡œ ë§Œë“¤ê¸°

    total = len(products)                       # ì´ ëª‡ ê°œì˜ ìƒí’ˆì´ ìˆëŠ”ì§€ ì„¸ê¸°
    most_common = Counter(products).most_common(1)  # ì œì¼ ë§ì´ ë‚˜ì˜¨ ìƒí’ˆ ì°¾ê¸°
    most_liked = most_common[0][0] if most_common else None  # ê²°ê³¼ êº¼ë‚´ê¸°

    return {
        'statusCode': 200,
        'body': {
            'ì´ê°œìˆ˜': total,
            'ê°€ì¥ë§ì´ì„ íƒëœ': most_liked
        }
    }
```
---
# CPU ì‚¬ìš©ë¥ ì´ ë†’ì•„ì§ˆ ë•Œ ì´ë©”ì¼ë¡œ ì•Œë¦¼ì„ ë³´ë‚´ëŠ” AWS Lambda ì½”ë“œë¥¼ ë§Œë“¤ì–´ ë“œë¦´ê²Œìš”.
### ì „ì²´ íë¦„
- Lambdaê°€ EC2 CPU ì‚¬ìš©ë¥ ì„ CloudWatchì—ì„œ ì¡°íšŒ
- CPU ì‚¬ìš©ë¥ ì´ ì„¤ì •í•œ ì„ê³„ì¹˜ ì´ìƒì´ë©´
- SNSë¡œ ì´ë©”ì¼ ì•Œë¦¼ ë°œì†¡
### ì‚¬ì „ ì¤€ë¹„
- AWS SNS ì£¼ì œ ë§Œë“¤ê³  ì´ë©”ì¼ êµ¬ë… ì‹ ì²­ (ì´ë©”ì¼ ìˆ˜ì‹  ë™ì˜ ì™„ë£Œ)
- Lambdaì— SNS í¼ë¯¸ì…˜ ë¶€ì—¬
- Lambda ì—­í• ì— EC2, CloudWatch, SNS ê¶Œí•œ ë¶€ì—¬

#### Lambda Python ì½”ë“œ (Python 3.13 ê¸°ì¤€)
```python
import boto3  # AWS ì„œë¹„ìŠ¤ë¥¼ íŒŒì´ì¬ì—ì„œ ì‰½ê²Œ ì‚¬ìš©í•  ìˆ˜ ìˆê²Œ ë„ì™€ì£¼ëŠ” ë¼ì´ë¸ŒëŸ¬ë¦¬
from datetime import datetime, timedelta  # ì‹œê°„ê³¼ ë‚ ì§œë¥¼ ë‹¤ë£° ë•Œ ì‚¬ìš©í•˜ëŠ” ëª¨ë“ˆ

# AWS ì„œë¹„ìŠ¤ ì¤‘ CloudWatchì™€ SNS(ì•Œë¦¼ ë³´ë‚´ëŠ” ì„œë¹„ìŠ¤) í´ë¼ì´ì–¸íŠ¸ ë§Œë“¤ê¸°
cloudwatch = boto3.client('cloudwatch')  # AWS CloudWatchì— ì ‘ê·¼í•˜ëŠ” í´ë¼ì´ì–¸íŠ¸ ê°ì²´ ìƒì„±
sns = boto3.client('sns')  # AWS SNS(Simple Notification Service)ì— ì ‘ê·¼í•˜ëŠ” í´ë¼ì´ì–¸íŠ¸ ê°ì²´ ìƒì„±

# ì•Œë¦¼ì„ ë°›ì„ SNS ì£¼ì œ(Topic)ì˜ ARN (Amazon Resource Name)
SNS_TOPIC_ARN = 'arn:aws:sns:ap-northeast-2:123456789012:MySNSTopic'  
# ìœ„ ë¬¸ìì—´ì€ SNS ì£¼ì œ ê³ ìœ  ì£¼ì†Œ, ì´ ì£¼ì†Œë¡œ ì•Œë¦¼ì´ ì „ì†¡ë¨

# ëª¨ë‹ˆí„°ë§ í•  EC2 ì¸ìŠ¤í„´ìŠ¤ ID (AWS EC2 ì„œë²„ì˜ ê³ ìœ  ì´ë¦„)
INSTANCE_ID = 'i-0123456789abcdef0'  # ì˜ˆì‹œ ì¸ìŠ¤í„´ìŠ¤ ID

# CPU ì‚¬ìš©ë¥ ì´ ì´ ê°’(80%)ì„ ë„˜ìœ¼ë©´ ê²½ê³  ì•Œë¦¼ì„ ë³´ëƒ„
CPU_THRESHOLD = 80.0  # CPU ì‚¬ìš©ë¥  ì„ê³„ê°’ (ë‹¨ìœ„: í¼ì„¼íŠ¸)

# AWS Lambda í•¨ìˆ˜ì˜ ì‹œì‘ì  - AWSê°€ í˜¸ì¶œí•  ë•Œ ì´ í•¨ìˆ˜ê°€ ì‹¤í–‰ë¨
def lambda_handler(event, context):
    # í˜„ì¬ ì‹œê°„(UTC ê¸°ì¤€) êµ¬í•˜ê¸°
    end_time = datetime.utcnow()  
    
    # í˜„ì¬ ì‹œê°„ì—ì„œ 5ë¶„ ì „ ì‹œê°„ êµ¬í•˜ê¸° (5ë¶„ ë™ì•ˆì˜ CPU ì‚¬ìš©ë¥  í™•ì¸í•˜ê¸° ìœ„í•¨)
    start_time = end_time - timedelta(minutes=5)

    # CloudWatchì—ì„œ CPU ì‚¬ìš©ë¥  í‰ê·  ë°ì´í„° ìš”ì²­í•˜ê¸°
    metrics = cloudwatch.get_metric_statistics(
        Namespace='AWS/EC2',  # ëª¨ë‹ˆí„°ë§í•  ì„œë¹„ìŠ¤ ì´ë¦„ (ì—¬ê¸°ì„œëŠ” EC2)
        MetricName='CPUUtilization',  # ì¸¡ì •í•  ì§€í‘œ (CPU ì‚¬ìš©ë¥ )
        Dimensions=[{'Name':'InstanceId', 'Value': INSTANCE_ID}],  # ì–´ë–¤ EC2 ì¸ìŠ¤í„´ìŠ¤ ë°ì´í„°ë¥¼ ê°€ì ¸ì˜¬ì§€ ì§€ì •
        StartTime=start_time,  # ì¡°íšŒ ì‹œì‘ ì‹œê°„
        EndTime=end_time,      # ì¡°íšŒ ì¢…ë£Œ ì‹œê°„
        Period=300,            # ë°ì´í„°ë¥¼ 5ë¶„ ë‹¨ìœ„(300ì´ˆ)ë¡œ ë¬¶ì–´ì„œ ì¡°íšŒ
        Statistics=['Average'] # CPU ì‚¬ìš©ë¥ ì˜ í‰ê· ê°’ì„ ìš”ì²­
    )

    # CloudWatchì—ì„œ ë°›ì€ ë°ì´í„°í¬ì¸íŠ¸(ì¸¡ì •ê°’ ë¦¬ìŠ¤íŠ¸)ë¥¼ ê°€ì ¸ì˜¤ê¸°
    datapoints = metrics.get('Datapoints')

    # ë°ì´í„°í¬ì¸íŠ¸ê°€ ì—†ìœ¼ë©´ (ë°ì´í„°ê°€ ì—†ìœ¼ë©´) ì •ìƒ ì¢…ë£Œ
    if not datapoints:
        return {
            'statusCode': 200,  # HTTP ìƒíƒœì½”ë“œ 200ì€ 'ì„±ê³µ'ì„ ì˜ë¯¸í•¨
            'body': 'CPU ì‚¬ìš©ë¥  ë°ì´í„°ê°€ ì—†ìŠµë‹ˆë‹¤.'  # ì‘ë‹µ ë©”ì‹œì§€, ë°ì´í„° ì—†ìŒì„ ì•Œë¦¼
        }

    # ì—¬ëŸ¬ ë°ì´í„°í¬ì¸íŠ¸ ì¤‘ ê°€ì¥ ìµœê·¼ ì‹œê°„ì˜ í‰ê·  CPU ì‚¬ìš©ë¥ ì„ ì„ íƒí•¨
    cpu_usage = sorted(datapoints, key=lambda x: x['Timestamp'], reverse=True)[0]['Average']

    # CPU ì‚¬ìš©ë¥ ì„ ì†Œìˆ˜ì  ë‘˜ì§¸ ìë¦¬ê¹Œì§€ ì¶œë ¥í•˜ê¸° ìœ„í•œ ì¶œë ¥ë¬¸
    print(f"í˜„ì¬ CPU ì‚¬ìš©ë¥ : {cpu_usage:.2f}%")

    # ë§Œì•½ CPU ì‚¬ìš©ë¥ ì´ ì„¤ì •í•œ ì„ê³„ì¹˜ë³´ë‹¤ í¬ë©´ (80% ì´ìƒì´ë©´)
    if cpu_usage > CPU_THRESHOLD:
        # ê²½ê³  ë©”ì‹œì§€ ë§Œë“¤ê¸° (ì–´ë–¤ ì¸ìŠ¤í„´ìŠ¤ê°€ ì–¼ë§ˆë‚˜ ë†’ê²Œ ì‚¬ìš©ì¤‘ì¸ì§€ í‘œì‹œ)
        message = f"ê²½ê³ : EC2 ì¸ìŠ¤í„´ìŠ¤ {INSTANCE_ID}ì˜ CPU ì‚¬ìš©ë¥ ì´ {cpu_usage:.2f}%ë¡œ ë†’ìŠµë‹ˆë‹¤!"
        
        # SNS ì„œë¹„ìŠ¤ë¥¼ ì‚¬ìš©í•´ ìœ„ì—ì„œ ë§Œë“  ë©”ì‹œì§€ë¥¼ ì•Œë¦¼ ì£¼ì œë¡œ ë°œì†¡
        sns.publish(
            TopicArn=SNS_TOPIC_ARN,  # ë©”ì‹œì§€ë¥¼ ë³´ë‚¼ SNS ì£¼ì œ ì£¼ì†Œ
            Message=message,         # ë³´ë‚¼ ë‚´ìš© (ë¬¸ìì—´)
            Subject='[AWS ì•Œë¦¼] CPU ì‚¬ìš©ë¥  ê²½ê³ '  # ì´ë©”ì¼ ì œëª©
        )
        print("ì•Œë¦¼ ì´ë©”ì¼ ë°œì†¡ ì™„ë£Œ")  # ì½˜ì†” ë¡œê·¸ ë‚¨ê¸°ê¸°
        
        # ì •ìƒì ìœ¼ë¡œ ì•Œë¦¼ì„ ë³´ëƒˆë‹¤ëŠ” ì˜ë¯¸ë¡œ HTTP 200 ìƒíƒœì½”ë“œì™€ ë©”ì‹œì§€ ë°˜í™˜
        return {
            'statusCode': 200,  # ìƒíƒœì½”ë“œ 200: ì •ìƒì²˜ë¦¬ ì™„ë£Œ
            'body': 'CPU ì‚¬ìš©ë¥  ê²½ê³  ì•Œë¦¼ ì´ë©”ì¼ ë°œì†¡ ì™„ë£Œ'  # ë°˜í™˜ ë©”ì‹œì§€
        }

    # CPU ì‚¬ìš©ë¥ ì´ ì„ê³„ì¹˜ë³´ë‹¤ ë‚®ìœ¼ë©´ ì•„ë˜ ë©”ì‹œì§€ë¥¼ ë°˜í™˜í•¨
    return {
        'statusCode': 200,  # ìƒíƒœì½”ë“œ 200: ì •ìƒì²˜ë¦¬ ì™„ë£Œ
        'body': f'CPU ì‚¬ìš©ë¥ ì€ ì •ìƒ ë²”ìœ„ì…ë‹ˆë‹¤: {cpu_usage:.2f}%'  # í˜„ì¬ CPU ì‚¬ìš©ë¥  ì •ë³´ë¥¼ ë©”ì‹œì§€ë¡œ ë³´ëƒ„
    }


```
---

# [ë¬¸ì œ 1 - DynamoDB ê´€ë ¨ ë¬¸ì œ]
- í…Œì´ë¸” ì´ë¦„: sgu-202500-3a
- íŒŒí‹°ì…˜ í‚¤: user_id (ë¬¸ìì—´)
- ì •ë ¬ í‚¤: timestamp (ë¬¸ìì—´)
- ì•„ë˜ ì¡°ê±´ì— ë§ëŠ” DynamoDB put_item ì½”ë“œë¥¼ ì‘ì„±í•˜ì„¸ìš”.
- user_id = "hong"
- timestamp = í˜„ì¬ ì‹œê°„ ISO í˜•ì‹
- product = "ì½œë¼"

```python
import boto3                     # AWS ì„œë¹„ìŠ¤ì™€ ì—°ê²°í•˜ê¸° ìœ„í•´ í•„ìš”í•œ ë„êµ¬ë¥¼ ê°€ì ¸ì™€ìš”
import json                      # JSON ë°ì´í„°ë¥¼ ë‹¤ë£¨ê¸° ìœ„í•´ ê°€ì ¸ì™€ìš”
from datetime import datetime    # í˜„ì¬ ì‹œê°„ì„ êµ¬í•˜ê¸° ìœ„í•´ ê°€ì ¸ì™€ìš”

def lambda_handler(event, context):        # AWS Lambdaê°€ ì‹¤í–‰í•  ë•Œ ì‹œì‘ë˜ëŠ” í•¨ìˆ˜
    body = json.loads(event['body'])       # ìš”ì²­ì—ì„œ ë³´ë‚¸ ë°ì´í„°ë¥¼ JSONìœ¼ë¡œ ë³€í™˜í•´ìš”
    
    user_id = body['user_id']               # JSONì—ì„œ user_idë¥¼ êº¼ë‚´ìš”
    product = body['product']               # JSONì—ì„œ productë¥¼ êº¼ë‚´ìš”
    timestamp = datetime.now().isoformat() # ì§€ê¸ˆ ì‹œê°„ì„ ISO í˜•ì‹ì˜ ë¬¸ìì—´ë¡œ ë§Œë“¤ì–´ìš”
    
    # DynamoDB í…Œì´ë¸”ê³¼ ì—°ê²°í•´ìš” (ê³„ì •, í•™ë…„ë°˜ì— ë§ê²Œ í…Œì´ë¸” ì´ë¦„ ìˆ˜ì •)
    table = boto3.resource('dynamodb').Table('sgu-202500-3a')
    
    # DynamoDBì— ë°ì´í„°ë¥¼ ë„£ì–´ìš”
    table.put_item(Item={
        'user_id': user_id,
        'timestamp': timestamp,
        'product': product
    })
    
    return {
        'statusCode': 200,
        'body': 'ì €ì¥ ì™„ë£Œ'
    }
```
---
# [ë¬¸ì œ 2 - Lambda í•¨ìˆ˜ ì‘ì„±]
- Lambda ì´ë¦„: sgu-202500-q2
- S3 ë²„í‚·ì—ì„œ JSON íŒŒì¼ì„ ì½ì–´ DynamoDB í…Œì´ë¸”ì— ë°ì´í„°ë¥¼ ì €ì¥í•˜ëŠ” Lambda í•¨ìˆ˜ë¥¼ ì‘ì„±í•˜ì„¸ìš”.
- S3 ë²„í‚·ëª…: sgu-202500-s3
- JSON íŒŒì¼ ê²½ë¡œ: data/input.json
- DynamoDB í…Œì´ë¸”: sgu-202500-3a
- JSON ë°°ì—´ ë‚´ ê° í•­ëª©ì€ user_id, productë¥¼ í¬í•¨
```python
# ë¬¸ì œ 2 - S3 JSON íŒŒì¼ ì½ê³  DynamoDBì— ì €ì¥
import boto3
import json
from datetime import datetime

def lambda_handler(event, context):
    s3 = boto3.client('s3')
    dynamodb = boto3.resource('dynamodb')
    table = dynamodb.Table('sgu-202500-3a')

    bucket = 'sgu-202500-s3'
    key = 'data/input.json'

    # S3ì—ì„œ JSON íŒŒì¼ ê°€ì ¸ì˜¤ê¸°
    response = s3.get_object(Bucket=bucket, Key=key)
    content = response['Body'].read().decode('utf-8')
    data_list = json.loads(content)

    # ê° í•­ëª©ì„ DynamoDBì— ì €ì¥
    for record in data_list:
        user_id = record.get('user_id')
        product = record.get('product')
        if not user_id or not product:
            continue
        item = {
            'user_id': user_id,
            'timestamp': datetime.now().isoformat(),
            'product': product
        }
        table.put_item(Item=item)

    return {
        'statusCode': 200,
        'body': 'ëª¨ë“  ë°ì´í„° ì €ì¥ ì™„ë£Œ!'
    }
```
---
# [ë¬¸ì œ 3 - Lambda í•¨ìˆ˜ ì‘ì„±]
- Lambda ì´ë¦„: sgu-202500-q3
- HTTP POST ìš”ì²­ ë³¸ë¬¸ì— í¬í•¨ëœ user_id, product, ê·¸ë¦¬ê³  ì„ íƒì  í•„ë“œ(reason, brand, price, color)ë¥¼ ë°›ì•„ DynamoDBì— ì €ì¥í•˜ëŠ” Lambda í•¨ìˆ˜ë¥¼ ì‘ì„±í•˜ì„¸ìš”.
```python
# ë¬¸ì œ 3 - POST ìš”ì²­ ë°ì´í„° DynamoDB ì €ì¥
import boto3
import json
from datetime import datetime

def lambda_handler(event, context):
    # POST ìš”ì²­ ë³¸ë¬¸ JSON íŒŒì‹±
    body = json.loads(event['body'])

    user_id = body['user_id']
    product = body['product']
    timestamp = datetime.now().isoformat()

    # ì„ íƒì  í•„ë“œ
    reason = body.get('reason')
    brand = body.get('brand')
    price = body.get('price')
    color = body.get('color')

    # DynamoDBì— ë„£ì„ ë°ì´í„° ë§Œë“¤ê¸°
    item = {
        'user_id': user_id,
        'timestamp': timestamp,
        'product': product
    }
    if reason:
        item['reason'] = reason
    if brand:
        item['brand'] = brand
    if price:
        item['price'] = price
    if color:
        item['color'] = color

    # DynamoDB ì €ì¥
    table = boto3.resource('dynamodb').Table('sgu-202500-3a')
    table.put_item(Item=item)

    # ì„±ê³µ ì‘ë‹µ
    return {
        'statusCode': 200,
        'body': json.dumps({'message': 'ì €ì¥ ì™„ë£Œ', 'user_id': user_id, 'timestamp': timestamp}, ensure_ascii=False)
    }

```
---
# [ë¬¸ì œ 4 - Lambda í•¨ìˆ˜ ì‘ì„±]
- Lambda ì´ë¦„: sgu-202500-q4
EC2 ì¸ìŠ¤í„´ìŠ¤ ìƒíƒœë¥¼ í™•ì¸í•´ 'running'ì´ ì•„ë‹ˆë©´ SNSë¡œ ì•Œë¦¼ì„ ë³´ë‚´ê³ , ë‹¤ë¥¸ Lambda(sgu-202500-LambdaB)ë¥¼ í˜¸ì¶œí•˜ì—¬ ì¸ìŠ¤í„´ìŠ¤ë¥¼ ì‹œì‘í•˜ëŠ” Lambda í•¨ìˆ˜ë¥¼ ì‘ì„±í•˜ì„¸ìš”.
```python
# ë¬¸ì œ 4 - EC2 ìƒíƒœ ì²´í¬, SNS ì•Œë¦¼, Lambda í˜¸ì¶œ
import boto3

ec2 = boto3.client('ec2')
sns = boto3.client('sns')
lambda_client = boto3.client('lambda')

INSTANCE_ID = 'i-xxxxxxxxxxxxxxxxx'  # EC2 ì¸ìŠ¤í„´ìŠ¤ ID
SNS_TOPIC_ARN = 'arn:aws:sns:region:account-id:topic-name'
LAMBDA_B_NAME = 'sgu-202500-LambdaB'

def lambda_handler(event, context):
    # EC2 ìƒíƒœ ì¡°íšŒ
    response = ec2.describe_instance_status(InstanceIds=[INSTANCE_ID], IncludeAllInstances=True)
    state = response['InstanceStatuses'][0]['InstanceState']['Name']

    # ìƒíƒœê°€ running ì•„ë‹ˆë©´ ì•Œë¦¼ ë° LambdaB í˜¸ì¶œ
    if state != 'running':
        message = f'ê²½ê³ : EC2 {INSTANCE_ID} ìƒíƒœê°€ {state}ì…ë‹ˆë‹¤.'
        sns.publish(TopicArn=SNS_TOPIC_ARN, Message=message, Subject='EC2 ìƒíƒœ ì•Œë¦¼')
        lambda_client.invoke(FunctionName=LAMBDA_B_NAME, InvocationType='Event', Payload=json.dumps({'InstanceId': INSTANCE_ID}))

    return {
        'statusCode': 200,
        'body': f'EC2 ìƒíƒœ: {state}'
    }
```
---
# [ë¬¸ì œ 5 - Lambda í•¨ìˆ˜ ì‘ì„±]
- Lambda ì´ë¦„: sgu-202500-q5
ê°„ë‹¨í•œ í…ìŠ¤íŠ¸ íŒŒì¼ì„ S3 ë²„í‚·ì— í˜„ì¬ ì‹œê°„ ê¸°ì¤€ ì´ë¦„ìœ¼ë¡œ ì—…ë¡œë“œí•˜ëŠ” Lambda í•¨ìˆ˜ë¥¼ ì‘ì„±í•˜ì„¸ìš”.
```python
# ë¬¸ì œ 5 - S3ì— í…ìŠ¤íŠ¸ íŒŒì¼ ì—…ë¡œë“œ
import boto3
from datetime import datetime

def lambda_handler(event, context):
    s3 = boto3.client('s3')
    bucket = 'sgu-202500-s3'
    now = datetime.now().strftime('%Y-%m-%d_%H-%M-%S')
    key = f'uploaded/hello_{now}.txt'
    content = f'Hello! íŒŒì¼ ìƒì„± ì‹œê°„: {now}'

    s3.put_object(Bucket=bucket, Key=key, Body=content.encode('utf-8'))

    return {
        'statusCode': 200,
        'body': 'íŒŒì¼ ì—…ë¡œë“œ ì™„ë£Œ!'
    }

```
---
# S3ì—ì„œ íŒŒì¼ì„ ë°›ì•„ì„œ ë‚´ìš©ì„ ë‚œìˆ˜ë¡œ ë°”ê¾¸ê³ , ë‹¤ì‹œ ì—…ë¡œë“œí•˜ëŠ” AWS Lambda ì½”ë“œ
```python
import json
import boto3          # AWS ë¦¬ì†ŒìŠ¤ë¥¼ ë‹¤ë£¨ê¸° ìœ„í•œ ëª¨ë“ˆ
import random         # ë‚œìˆ˜ ìƒì„±ìš©
import string         # ì•ŒíŒŒë²³ ë¬¸ì ë¦¬ìŠ¤íŠ¸ìš©

s3 = boto3.client('s3')  # S3 í´ë¼ì´ì–¸íŠ¸ ìƒì„±

def lambda_handler(event, context):
    # 1. ì‚¬ìš©í•  ë²„í‚· ì´ë¦„ê³¼ íŒŒì¼ í‚¤ ì§€ì •
    bucket_name = 'your-bucket-name'      # ğŸ” ì‹¤ì œ ì‚¬ìš© ì¤‘ì¸ ë²„í‚· ì´ë¦„ìœ¼ë¡œ ìˆ˜ì •
    file_key = 'input/test.txt'           # ğŸ” íŒŒì¼ ê²½ë¡œ ì˜ˆì‹œ

    # 2. S3ì—ì„œ íŒŒì¼ ë‹¤ìš´ë¡œë“œ
    response = s3.get_object(Bucket=bucket_name, Key=file_key)
    original_data = response['Body'].read().decode('utf-8')  # ë¬¸ìì—´ë¡œ ë³€í™˜

    # 3. ì›ë˜ ë°ì´í„° ì¶œë ¥ (ë””ë²„ê¹…ìš©)
    print("ì›ë˜ íŒŒì¼ ë‚´ìš©:", original_data)

    # 4. ë‚œìˆ˜ë¡œ ë°”ê¾¼ ìƒˆ ë°ì´í„° ìƒì„± (ì˜ˆ: ëœë¤ ë¬¸ìì—´ 10ê°œ)
    new_lines = []
    for _ in range(10):
        rand_str = ''.join(random.choices(string.ascii_letters + string.digits, k=10))
        new_lines.append(rand_str)

    new_data = '\n'.join(new_lines)

    # 5. ìƒˆë¡œìš´ ë‚´ìš© ì¶œë ¥ (ë””ë²„ê¹…ìš©)
    print("ìƒˆë¡œìš´ ë‚´ìš©:", new_data)

    # 6. ìƒˆ ë°ì´í„° S3ì— ë‹¤ì‹œ ì—…ë¡œë“œ (ê°™ì€ íŒŒì¼ ì´ë¦„ìœ¼ë¡œ ë®ì–´ì“°ê¸°)
    s3.put_object(Bucket=bucket_name, Key=file_key, Body=new_data.encode('utf-8'))

    # 7. ê²°ê³¼ ë¦¬í„´
    return {
        'statusCode': 200,
        'body': json.dumps('íŒŒì¼ì´ ì„±ê³µì ìœ¼ë¡œ ìˆ˜ì •ë˜ì—ˆìŠµë‹ˆë‹¤!')
    }
```
---
# CSV íŒŒì¼ â€“ ë‚´ìš©ì„ ë‚œìˆ˜ë¡œ ë³€ê²½ í›„ ë‹¤ì‹œ ì €ì¥
```python
import boto3
import random
import string
import csv
import io

s3 = boto3.client('s3')

def lambda_handler(event, context):
    bucket = 'your-bucket-name'
    key = 'original/sample.csv'

    # S3ì—ì„œ csv íŒŒì¼ ê°€ì ¸ì˜¤ê¸°
    response = s3.get_object(Bucket=bucket, Key=key)
    content = response['Body'].read().decode('utf-8')
    
    # csv ë‚´ìš© íŒŒì‹±
    reader = csv.reader(io.StringIO(content))
    rows = list(reader)
    
    # ì²« ë²ˆì§¸ í–‰ì€ í—¤ë”
    header = rows[0]
    
    # ë‚˜ë¨¸ì§€ ë‚´ìš©ì€ ë‚œìˆ˜ë¡œ ë³€ê²½
    randomized_rows = [header]
    for row in rows[1:]:
        randomized_row = [''.join(random.choices(string.ascii_letters + string.digits, k=len(cell))) for cell in row]
        randomized_rows.append(randomized_row)

    # CSVë¡œ ë‹¤ì‹œ ì €ì¥
    output = io.StringIO()
    writer = csv.writer(output)
    writer.writerows(randomized_rows)
    
    s3.put_object(Bucket=bucket, Key='modified/sample.csv', Body=output.getvalue().encode('utf-8'))

    return {'statusCode': 200, 'body': 'CSV íŒŒì¼ ë‚œìˆ˜ë¡œ ë³€ê²½ ì™„ë£Œ'}
```
---
# JSON íŒŒì¼ â€“ ê°’ë“¤ì„ ë‚œìˆ˜ë¡œ ë°”ê¾¸ê¸°
```python
import boto3
import json
import random
import string

s3 = boto3.client('s3')

def random_string(length):
    return ''.join(random.choices(string.ascii_letters + string.digits, k=length))

def randomize_json(obj):
    if isinstance(obj, dict):
        return {k: randomize_json(v) for k, v in obj.items()}
    elif isinstance(obj, list):
        return [randomize_json(v) for v in obj]
    elif isinstance(obj, str):
        return random_string(len(obj))
    else:
        return obj  # ìˆ«ì, bool ë“±ì€ ê·¸ëŒ€ë¡œ

def lambda_handler(event, context):
    bucket = 'your-bucket-name'
    key = 'original/sample.json'

    response = s3.get_object(Bucket=bucket, Key=key)
    content = response['Body'].read().decode('utf-8')
    
    data = json.loads(content)
    randomized_data = randomize_json(data)
    
    s3.put_object(
        Bucket=bucket,
        Key='modified/sample.json',
        Body=json.dumps(randomized_data).encode('utf-8')
    )

    return {'statusCode': 200, 'body': 'JSON íŒŒì¼ ë‚œìˆ˜ë¡œ ë³€ê²½ ì™„ë£Œ'}
```
---
# Image (JPEG/PNG) â€“ ê°„ë‹¨í•œ íšŒì „ í›„ ë‹¤ì‹œ ì €ì¥
```python
import boto3
from PIL import Image
import io

s3 = boto3.client('s3')

def lambda_handler(event, context):
    bucket = 'your-bucket-name'
    key = 'original/sample.jpg'  # PNGë„ ê°€ëŠ¥

    # S3ì—ì„œ ì´ë¯¸ì§€ ê°€ì ¸ì˜¤ê¸°
    response = s3.get_object(Bucket=bucket, Key=key)
    image_data = response['Body'].read()
    
    # ì´ë¯¸ì§€ ì—´ê¸°
    image = Image.open(io.BytesIO(image_data))
    
    # ì´ë¯¸ì§€ íšŒì „ (90ë„)
    rotated = image.rotate(90)

    # ìƒˆ ì´ë¯¸ì§€ ì €ì¥ ì¤€ë¹„
    buffer = io.BytesIO()
    rotated.save(buffer, format='JPEG')  # PNGì´ë©´ format='PNG'
    buffer.seek(0)

    # ë‹¤ì‹œ ì—…ë¡œë“œ
    s3.put_object(
        Bucket=bucket,
        Key='modified/sample_rotated.jpg',
        Body=buffer,
        ContentType='image/jpeg'
    )

    return {'statusCode': 200, 'body': 'ì´ë¯¸ì§€ íšŒì „ í›„ ì—…ë¡œë“œ ì™„ë£Œ'}
```
---
